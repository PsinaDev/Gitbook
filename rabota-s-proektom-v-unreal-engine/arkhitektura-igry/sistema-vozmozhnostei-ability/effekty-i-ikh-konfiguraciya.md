# Эффекты и их конфигурация

Эффекты настраиваются через DataAsset.\
Существует два главных класса Эффектов. DT\_EffectPrimary и DT\_EffectAggregator. О них ниже

## Справка по полям эффекта из DT\_EffectPrimary

**Effect (Эффект)**

* **Effect Tag**\
  Метка, идентифицирующая данный эффект.\
  Пример: `Effect.Damage`. Используется для связывания эффекта с логикой геймплея, фильтрации и управления эффектами.

***

**Attribute Condition (Условие для атрибутов)**

Используется для задания условий, при которых эффект может быть применён.

* **AttributeTag**\
  Метка атрибута, на который проверяется условие.\
  Пример: `Attributes.Human.Health` — проверка здоровья.
* **TypeOfCondition**\
  Тип логического условия, например:
  * `A Greater Than B` — проверяет, что значение атрибута больше указанного.
  * Другие варианты могут включать `Less Than`, `Equal To`, и т.д.
* **Value**\
  Числовое значение для сравнения.\
  Пример: `0.0` — атрибут должен быть больше нуля. Проверяется Current (текущее) значение атрибута.
* **Logic Link**\
  Логическая связь между условиями (если их несколько).\
  Пример: `AND, OR, XOR, NAND NOR и пр.`

***

**Destroy on Block (Удалить при блокировке)**

Флаг, определяющий, будет ли эффект удалён, если его применение заблокировано.\
Пример: если true, то эффект снимается при блокировке.

***

**Application Policy (Политика применения)**

Определяет, как применяется эффект:

* `Momentary` — применяется сразу.&#x20;
* `Periodic` — применяется по времени

***

**Duration Policy (Политика длительности)**

Задаёт режим работы эффекта с точки зрения времени:

* `ForDuration` — эффект работает в течение заданной длительности.
* `Instant` — удаляется сразу после применения.
* `Infinite`— существует в мире пока не будет удален по внешним причинам.

***

**Duration (Длительность)**

Продолжительность действия эффекта в секундах.\
Пример: `0.5` секунд.

***

**Calculation Frequency (Частота расчёта)**

Интервал времени (в секундах), через который рассчитывается эффект и происходит обсчет атрибутов.\
Пример: `0.1` секунд.

***

**Calculate on Duration (Расчёт по длительности)**

Флаг, который указывает, должен ли эффект плавно интерполировать значения по времени. Существует косметическая интерполяция (в UI например, когда прогресс бар плавно меняется до текущего значения) и реальная, когда параметр действительно меняется плавно. Такой обсчет незначительно дороже, но перебарщивать с ним не стоит.

***

**Stack Mode (Режим стека)**

Определяет поведение эффекта при наложении нескольких копий.\
`None` —  Эффект просто добавляется, вне зависимости от уже активных\
`Ignore` — новые эффекты игнорируются, если аналогичный уже активен.\
`Replace` — Новый эффект заменяет аналогичный уже активный\
`Acumulate` — На момент написания документации не реализованная фича. Предполагается добавление правил аккумуляции (складывания) нескольких эффектов

***

**Modifications (Модификации)**

Определяет, как эффект влияет на атрибуты.

* **Attribute Tag**\
  Атрибут, на который влияет модификация.\
  Пример: `Attributes.Human.Health`.
* **Operation**\
  Операция, выполняемая над атрибутом:
  * `Add` — добавление.
  * Другие варианты: `Multiply`, `Override`.
* **Value**\
  Величина изменения.\
  Пример: `-50.0` — уменьшение здоровья на 50.
* **ValueType**\
  Тип значения модификации:
  * `Const` — константа.
  * Может быть также `Percent` от какого-либо значения атрибута.
* **bThreshold**\
  Флаг, задающий использование пороговых значений.
* **ThresholdData**\
  Дополнительные параметры для обработки порогов (если `bThreshold` активен).

**ThresholdData**

Блок данных, определяющий поведение при достижении определённых пороговых значений атрибута. Используется для активации дополнительных эффектов, изменения состояния или удаления атрибутов.

***

* **ThresholdValue (Значение порога)**\
  Указывает числовое значение, которое считается пороговым.\
  Пример: `0.0` — пороговое значение.
* **TypeOfThresholdValue (Тип значения порога)**\
  Тип данных, используемый для порогового значения:
  * `Constant` — фиксированное значение.
  * Другие варианты: например, относительное или динамическое.
* **ThresholdCondition (Условие порога)**\
  Определяет условие, при котором срабатывает порог:
  * `MoreThanOrEqual` — значение больше или равно порогу.
  * Другие варианты: `LessThan`, `EqualTo`, и т.д.
* **ValueOnThresholdReached (Значение при достижении порога)**\
  Задаёт действие с атрибутом при достижении порога:
  * `Keep` — Продолжить обсчет по правилам модификации
  * `SetToTreshold`   — остановить при достижении порога.
* **bStopOnThreshold (Остановить на пороге)**\
  Флаг, указывающий, нужно ли останавливать дальнейшие модификации атрибута при достижении порога.\
  Пример: если true, атрибут блокируется на пороговом значении.

***

**ThresholdResult (Результат при достижении порога)**

Определяет действия, которые происходят при достижении указанного порогового значения.

* **Action (Действие)**\
  Задаёт тип выполняемых действий:
  * `Add & Remove` — добавление и удаление эффектов или тегов.
  * Другие варианты: только добавление (`Add`), только удаление (`Remove`).
* **EffectsToAdd (Эффекты для добавления)**\
  Массив эффектов, которые должны быть добавлены при достижении порога.
* **EffectsToRemove (Эффекты для удаления)**\
  Массив эффектов, которые должны быть удалены при достижении порога.
* **RemoveTagsOnThreshold (Удалить теги при пороге)**\
  Список тегов, которые удаляются при достижении порога.
* **AddTagsOnThreshold (Добавить теги при пороге)**\
  Список тегов, которые добавляются при достижении порога.

***

**Tags (Теги)**

Теги, определяющие дополнительные условия и логику применения.

* **Require Tags**\
  Список тегов, которые должны присутствовать, чтобы эффект сработал.
* **Blocking Tags**\
  Список тегов, блокирующих эффект.

***

**OnActivated (При активации)**

Определяет действия, которые выполняются при активации эффекта.

* **Remove Additional Tags on Activation**\
  Удаление дополнительных тегов при активации.
* **Remove Immune Tags on Activation**\
  Удаление "иммунных" тегов при активации.
* **Add Additional Tags on Activation**\
  Добавление дополнительных тегов при активации.
* **Add Immune Tags on Activation**\
  Добавление "иммунных" тегов при активации.

***

**OnRemoved (При удалении)**

Определяет действия, которые выполняются при удалении эффекта.

* **Add Additional Tags on Removed**\
  Добавление дополнительных тегов при удалении.
* **Add Immune Tags on Removed**\
  Добавление "иммунных" тегов при удалении.
* **Remove Immune Tags on Removed**\
  Удаление "иммунных" тегов при удалении.
* **Remove Additional Tags on Removed**\
  Удаление дополнительных тегов при удалении.

***

## Справка по параметрам датасета **Effect Aggregator**

**EffectAggregator -** тип эффекта, который может накладывать другие эффекты. Большая часть параметров аналогична DT\_EffectPrimary. Пункты, отличающиеся от него, приведены ниже.

***

#### **OnActivate (При активации)**

Определяет действия, которые должны быть выполнены в момент активации эффекта.

* **Activation Actions (Действия при активации)**
  * **Action (Действие)**\
    Определяет, что будет выполнено при активации:
    * `Nothing` — никаких действий не выполняется.
    * Другие значения могут включать добавление эффектов, изменение состояния и т.д.
  * **EffectsToAdd (Эффекты для добавления)**\
    Массив эффектов, которые добавляются при активации.
  * **EffectsToRemove (Эффекты для удаления)**\
    Массив эффектов, которые удаляются при активации.

***

#### **OnRemove (При удалении)**

Определяет действия, которые выполняются при удалении эффекта.

* **Remove Actions (Действия при удалении)**
  * **Action (Действие)**\
    Задаёт тип действий, выполняемых при удалении:
    * `Nothing` — никаких действий не выполняется.
    * Другие значения позволяют добавлять или убирать эффекты.
  * **EffectsToAdd (Эффекты для добавления)**\
    Массив эффектов, которые добавляются при удалении эффекта.
  * **EffectsToRemove (Эффекты для удаления)**\
    Массив эффектов, которые удаляются при удалении эффекта.
* **Apply Remove on Block (Применить удаление при блокировке)**\
  Логический параметр (булевое значение), указывающий, следует ли активировать удаление эффектов, если агрегатор был заблокирован.
