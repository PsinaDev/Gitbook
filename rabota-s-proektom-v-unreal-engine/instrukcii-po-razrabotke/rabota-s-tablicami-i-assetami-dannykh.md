# Работа с таблицами и ассетами данных

## Справка: Разница между **DataTable** и **DataAsset** в Unreal Engine

В Unreal Engine **DataTable** и **DataAsset** используются для хранения и управления данными. Оба подхода имеют свои особенности и применяются в зависимости от ситуации.

***

### **DataTable**

**DataTable** — это таблица данных, обычно хранящая строки, каждая из которых соответствует одной записи, связанной с заранее определённой структурой (`USTRUCT`).

**Особенности:**

1. **Основной формат:**
   * Таблицы данных представляют собой CSV-файл или JSON, импортированный в Unreal Engine.
   * Основаны на структуре (`USTRUCT`), которая определяет поля и их типы.
2. **Редактирование:**
   * Удобно для массового изменения данных в виде таблицы.
   * Поддерживает редактирование напрямую в редакторе или экспорт в CSV/JSON для работы в сторонних инструментах (например, Excel).
3. **Чтение данных:**
   * Читается через Blueprint или C++ код с помощью функций `FindRow`, `GetAllRows`, и других методов.
4. **Размер данных:**
   * Подходит для больших массивов данных, таких как настройки уровней, врагов, предметов и т.д.
5. **Преимущества:**
   * Удобно для структурированных данных с множеством записей (например, 100+ строк).
   * Легко использовать с системами, требующими массовое изменение данных.
6. **Ограничения:**
   * Не поддерживает ссылки на другие объекты UE (например, на материалы, текстуры, звуки).
   * Менее удобен для сложных, вложенных структур данных.

***

### **DataAsset**

**DataAsset** — это объект на основе класса (`UDataAsset`), который позволяет создавать индивидуальные файлы с данными.

**Особенности:**

1. **Основной формат:**
   * Создаётся в UE как ресурс с собственным экземпляром данных.
   * Основан на классе, который наследуется от `UDataAsset` и может содержать как простые, так и сложные данные (включая ссылки на UE-объекты).
2. **Редактирование:**
   * Полностью редактируется в редакторе Unreal Engine, в визуальном интерфейсе.
   * Позволяет устанавливать сложные вложенные структуры, массивы, ссылки на объекты (актеры, текстуры, материалы, звуки).
3. **Чтение данных:**
   * Получение данных идёт через ссылки на экземпляры `DataAsset` в Blueprint или C++.
4. **Размер данных:**
   * Подходит для хранения небольшой или средней по объёму информации (например, свойства персонажей, наборы анимаций).
5. **Преимущества:**
   * Полная интеграция с UE-объектами.
   * Поддерживает более сложные структуры данных, включая вложенные массивы и связи.
   * Поддерживает статические функции внутри себя.
6. **Ограничения:**
   * Менее удобен для работы с большими наборами данных.
   * Может быть неудобен для массовых изменений.

***

#### **Когда использовать DataTable**

* Если нужно хранить **много строк однотипных данных** (например, статистику предметов, врагов, таблицы уровней опыта).
* Если данные должны быть легко изменяемыми в сторонних инструментах (например, Excel).
* Когда структура данных проста и не требует большого кол-ва ссылок на UE-объекты.

**Пример:**

* Таблица характеристик врагов (имя, здоровье, урон).
* Таблица уровней и связанной с ними информации (опыт, награды).

***

#### **Когда использовать DataAsset**

* Если требуется **сложная структура данных** с вложенными объектами или ссылками на ресурсы Unreal Engine (материалы, звуки, текстуры).
* Для уникальных или специализированных данных, которые легче настраивать в редакторе.
* Когда данные связаны с игровыми системами (например, создание перков, модификации оружия, настройки персонажей).

**Пример:**

* Конфигурация оружия с ссылками на звуки выстрелов, материалы, анимации.
* Уникальные свойства персонажей (способности, эффекты).
* Данные анимации для набора действий (ходьба, бег, прыжок).

***

#### **Сравнительная таблица**

| **Критерий**            | **DataTable**                       | **DataAsset**                          |
| ----------------------- | ----------------------------------- | -------------------------------------- |
| Формат                  | Таблица (CSV/JSON)                  | Объект в UE                            |
| Структура данных        | Простой и однотипный набор          | Сложные данные, ссылки на объекты      |
| Удобство редактирования | Удобно в Excel, неудобно для ссылок | Удобно для объектов и сложных структур |
| Масштабируемость        | Большие наборы данных               | Небольшие или средние наборы данных    |
| Пример использования    | Таблицы уровней, врагов, статистики | Настройки персонажа, оружия, эффектов  |

## Создание таблицы данных (DataTable)

Таблицы данных в Unreal Engine нужны для удобного хранения однотипных данных. Работают они достаточно просто; для начала нужно создать структуру (UserDefinedStruct), а затем выбрать эту структуру как **основу для строки таблицы.&#x20;**<mark style="color:red;">**Если вам нужно создать таблицу для уже существующих данных, пропустите шаги 1 - 3.**</mark>

1. Создайте структуру.

<figure><img src="../../.gitbook/assets/image (89).png" alt=""><figcaption></figcaption></figure>

2. Заполните структуру нужными вам типами данных

<figure><img src="../../.gitbook/assets/image (91).png" alt=""><figcaption></figcaption></figure>

3.  По желанию укажите значения по умолчанию данной структуры:\
    \


    <figure><img src="../../.gitbook/assets/image (36).png" alt=""><figcaption></figcaption></figure>
4. Создайте таблицу.\


<figure><img src="../../.gitbook/assets/image (34).png" alt=""><figcaption></figcaption></figure>

5.  В качестве основы для строки таблицы в появившемся окне выберите структуру.\


    <figure><img src="../../.gitbook/assets/image (37).png" alt=""><figcaption></figcaption></figure>


6.  В появившемся редакторе таблицы добавьте необходмое количество строк. Называйте строки осмысленно, например, для таблицы интерактивных предметов, категоризируйте строки как "Door" или "Item"\


    <figure><img src="../../.gitbook/assets/image (38).png" alt=""><figcaption></figcaption></figure>


7.  Поскольку в структуре было какое-то значение по умолчанию, новая созданная строка сразу их хранит:\


    <figure><img src="../../.gitbook/assets/image (39).png" alt=""><figcaption></figcaption></figure>



## Создание ассета с данными (Data Asset).

<mark style="color:red;">**Если вам нужно создать Data Asset от уже существующего шаблона, пропустите шаги 1 - 2.**</mark>

1.  Создайте Blueprint-Class, отнаследованный от PrimaryDataAsset.\


    <figure><img src="../../.gitbook/assets/image (42).png" alt=""><figcaption></figcaption></figure>


2.  Откройте появившийся ассет и добавьте в него необходимые переменные и функции. В примере датасет хранит 3 boolean переменные, одну анимацию и pure - функцию, которая позволяет легко посчитать AND всех трех булевых\


    <figure><img src="../../.gitbook/assets/image (43).png" alt=""><figcaption></figcaption></figure>

    <figure><img src="../../.gitbook/assets/image (44).png" alt=""><figcaption></figcaption></figure>

    Важное замечание - функции в DataAsset не предназначены для работы с какой-либо геймплейной логикой. Они нужны больше как Getter - функции и функции которые предоставляют некоторые обсчеты.
3.  Создайте экземпляр Data Asset.\


    <figure><img src="../../.gitbook/assets/image (46).png" alt=""><figcaption></figcaption></figure>


4.  В появившемся окне выберите Parent-class для вашего Data Asset Instance.\


    <figure><img src="../../.gitbook/assets/image (47).png" alt=""><figcaption></figcaption></figure>


5.  Открыв DataAsset вы можете указать значения.

    <figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>
