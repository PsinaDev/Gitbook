---
description: Опасно. Делать только в крайних случаях.
---

# Переписывание истории

### В случае если вы с концами сломали дерево гита, вы можете переписать историю, сделав Force Push.

1. В настройках репозитория включите опцию Force Push.

<figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXc59aICF4nmYh1Ntx3LIEiY2aEU-6pomn6X5aeaNZaM0mxMJiwkKb9n4NPXZSTyWqp6VhoMJUdWi31UGIzusod-aLR0fjaQ6hZ61qx1WwLrn_NQgiKAkM6FJA42Jeucr1-EWg7NG3CbFSs6nvpg5WFmzlPK?key=MFvsAmq73t2EaIJsyKb_tA" alt=""><figcaption></figcaption></figure>

2. **Если вам нужен старый коммит:**

*   **Перейдите на коммит, который должен стать новым ведущим коммитом на сервере**\


    <figure><img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXesGWMNpNSZnNc3XsJEv8h-U8g7m721fZHY0pdU2OOAGD4nKfAykcjSONN1DgfLtQW19TmCtPwz7anDUjt4FS-NB1sZdwnj2T5g55vSuzVYgBWm33Z46UzfAhmGVpxZR_oL2J64vuIdCpaTj_Hzw1jsdP_k?key=MFvsAmq73t2EaIJsyKb_tA" alt=""><figcaption></figcaption></figure>
* **Откройте Git Bash, и вбейте следующую команду:**

```bash
git push origin HEAD:main --force
```

## Как обновить дерево после переписывания истории.

### Шаги для других разработчиков:

#### \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

#### Что делать, если изменения нужно сохранить:

Если разработчики хотят сохранить свои изменения перед тем, как сбросить локальную ветку, они могут создать новую ветку для этих изменений:

```bash
git checkout -b my-feature-branch
```

Затем они могут вернуться к ветке main и выполнить принудительный сброс.\
\
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_



1. **Обновить удалённые ссылки**\
   Для начала разработчики должны обновить информацию о ветке main на удалённом репозитории:\
   \
   git fetch origin\
   \
   Это обновит информацию о состоянии веток, включая изменения в удалённой ветке main.



2. **Переключиться на ветку main**\
   Далее нужно убедиться, что они находятся на ветке main:\
   \
   git checkout main\

3. **Пересинхронизировать ветку main с удалённым репозиторием**\
   Теперь нужно принудительно синхронизировать локальную ветку с состоянием удалённой ветки main. Поскольку удалённая ветка была откатана с помощью force push, разработчики также должны принудительно обновить свою локальную копию:

```bash
git reset --hard origin/main
```

Эта команда сбросит локальную ветку main к тому состоянию, которое сейчас находится на удалённом репозитории. Все локальные изменения, которые не были закоммичены или сохранены в других ветках, будут потеряны.\
\


4. Удалить лишние локальные изменения (опционально)\
   **Эта команда удаляет все неотслеживаемые файлы и каталоги. Будьте осторожны при использовании, так как она может удалить рабочие файлы.**\
   \
   Если у них есть незафиксированные изменения или файлы, которые конфликтуют с состоянием main, им может понадобиться откатить или удалить эти изменения. Например, команда для удаления незафиксированных изменений:

```bash
git clean -fd
```
